import styles from "../styles/Home.module.scss";
import { useState, useEffect } from "react";
import { motion } from "framer-motion";
import services from "../utils/services.js";
import Timer from "./timer.js";

export default function Home() {
	const [getSlideUpValue, setSlideUpValue] = useState("350");
	const [getQuizData, setQuizData] = useState();
	const [currentQuestionIndex, setQuestionIndex] = useState(0);

	useEffect(() => {
		async function setDataState() {
			let data = await services.getQuiz();
			setQuizData(Object.entries(data));
		}
		setDataState();
	}, []);

	return (
		<div className={styles.wrapper}>
			<header>
				<title>Quiz</title>
				<meta
					name="description"
					content="Generated by create next app"
				/>
				<link rel="icon" href="/favicon.ico" />
				<link
					rel="stylesheet"
					href="https://use.typekit.net/sly1ocm.css"
				/>
				<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
			</header>

			<main className={styles.main}>
				<motion.div
					animate={{
						y: -70,
						opacity: 1
					}}
					initial={{ opacity: 0.5, y: 50 }}
					transition={{
						type: "spring",
						stiffness: 170
					}}
					className={styles.quizContainer}>
					<Timer></Timer>
					{getQuizData ? (
						<motion.div
							className={styles.innerContainer}
							style={{ maxHeight: getSlideUpValue }}
							animate={{
								y: -15
							}}
							transition={{
								type: "spring",
								stiffness: 100,
								delay: 0
							}}
							initial={{ y: 60 }}>
							<div className={styles.quizTitle}>
								{getQuizData
									? getQuizData[currentQuestionIndex][1]
											.question
									: ""}
							</div>

							{getQuizData[2][1]?.codeQuestion ? (
								<div className={styles.quizQuestionContainer}>
									<pre class="prettyprint lang-javascript inenums:4">
										{getQuizData[2][1].codeQuestion}
									</pre>
								</div>
							) : null}

							<div className={styles.quizAnswers}>
								<div
									className={styles.answer}
									onClick={(e) => {
										setSlideUpValue("0");
									}}>
									<div>
										<span>A</span>
									</div>
									<pre class="prettyprint">
										const item =
										document.querySelector(".item");
									</pre>
								</div>
								<div className={styles.answer}>
									<div>
										<span>B</span>
									</div>
									<pre class="prettyprint linenums">
										const item
										=document.querySelector(".item");
									</pre>
								</div>
							</div>
						</motion.div>
					) : null}
				</motion.div>
			</main>
		</div>
	);
}
